        -:    0:Source:/home/neo/MedicamentLibrary/common/db/creational/factory/db_interface_factory.hpp
        -:    0:Graph:/home/neo/MedicamentLibrary/cmake-build-ninja--vcpkg-dbg-rel-coverage/tests/CMakeFiles/DrugLib_Tests_Unit_TransactionManager.dir/unit_tests/transaction_manager/test_transaction_manager.cpp.gcno
        -:    0:Data:/home/neo/MedicamentLibrary/cmake-build-ninja--vcpkg-dbg-rel-coverage/tests/CMakeFiles/DrugLib_Tests_Unit_TransactionManager.dir/unit_tests/transaction_manager/test_transaction_manager.cpp.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#pragma once
        -:    2:
        -:    3:#include <iostream>
        -:    4:#include <memory>
        -:    5:
        -:    6:#include "db_interface.hpp"
        -:    7:#include "mock_db_client.hpp"
        -:    8:#include "pqxx_client.hpp"
        -:    9:
        -:   10:namespace drug_lib::common::database::creational
        -:   11:{
        -:   12:    class DbInterfaceFactory
        -:   13:    {
        -:   14:    public:
        -:   15:        static std::shared_ptr<interfaces::DbInterface> create_pqxx_client(const PqxxConnectParams& _params)
        -:   16:        {
        -:   17:            std::shared_ptr<interfaces::DbInterface> connect;
        -:   18:            try
        -:   19:            {
        -:   20:                connect = std::make_shared<PqxxClient>(_params);
        -:   21:            }
        -:   22:            catch (const exceptions::ConnectionException& e)
        -:   23:            {
        -:   24:                std::cerr << e.what() << std::endl;
        -:   25:
        -:   26:                try
        -:   27:                {
        -:   28:                    PqxxClient::create_database(_params);
        -:   29:                    connect = std::make_shared<PqxxClient>(_params);
        -:   30:                }
        -:   31:                catch (const std::exception& inner_e)
        -:   32:                {
        -:   33:                    std::string msg = "Failed to open database connection. Cascade of fails.";
        -:   34:                    msg.append(inner_e.what());
        -:   35:                    throw exceptions::ConnectionException(msg,
        -:   36:                                                          errors::db_error_code::CONNECTION_FAILED);
        -:   37:                }
        -:   38:            }
        -:   39:            return connect;
        -:   40:        }
        -:   41:
function _ZN8drug_lib6common8database10creational18DbInterfaceFactory20create_mock_databaseEv called 6 returned 100% blocks executed 100%
        6:   42:        static std::shared_ptr<interfaces::DbInterface> create_mock_database()
        -:   43:        {
        6:   44:            return std::make_shared<MockDbClient>();
        6:   44-block  0
        -:   45:        }
        -:   46:
        -:   47:        template <typename... Args>
function _ZN8drug_lib6common8database10creational18DbInterfaceFactory20create_mock_databaseIJPKciS6_S6_S6_EEESt10shared_ptrINS1_10interfaces11DbInterfaceEEDpT_ called 6 returned 100% blocks executed 100%
        6:   48:        static std::shared_ptr<interfaces::DbInterface> create_mock_database(Args... argv)
        -:   49:        {
        6:   50:            return std::make_shared<MockDbClient>(argv...);
        6:   50-block  0
        -:   51:        }
        -:   52:    };
        -:   53:}
